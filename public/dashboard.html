<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Dashboard </title>
    <link rel="stylesheet" href="styles.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head> 

<body>

    <header class="header">
        <nav class="navbar">
            <a href="">Home</a>
            <a href="">Contacts</a>
            <a href="">Services</a>
            <a href="">Contacts</a>
        </nav>
        <form action="" class="search-bar">
            <input type="text" placeholder="Search.....">
            <button type="submit"><i class='bx bx-search'></i></button>
        </form>
    </header>
<div class="background"></div>


    <div class="container">
        <div class="content">
            <h2 class="logo"><i class='bx bxl-firefox' ></i>Le Grande</h2>

            <div class="text-sci">
                <h2>Welcome! <br><span>        <div class="sidebar-welcome">
                   <span id="userEmail">[User's Email]</span>
                </div></span></h2>
                <p>Brave adventurer, welcome to the Realm of Secrets. 
                Beyond these gates lie mysteries untold, treasures yet 
                to be claimed, and challenges to test your might. Fear 
                not the unknown, for with courage, the path shall be 
                revealed. Step forth, wield your strength, and prove 
                your valor in the quest that awaits!.</p>
            </div>

            <div class="social-icon">
                <a href=""><i class='bx bxl-instagram-alt' ></i></a>
                <a href=""><i class='bx bxl-facebook-circle' ></i></a>
                <a href=""><i class='bx bxl-gmail' ></i></a>
                <a href=""></a>
            </div>
        </div>
            
        <div class="logreg-box">
            <div class="form-box login">
                <form action="">
                    <h2>Enter the Realm</h2>
                
                    <div class="input-box">
                        <span class="icon">
                            <i class='bx bx-envelope'></i>
                        </span>
                        <input type="email" required>
                        <label>Traveler's ID (Email)</label>
                    </div>
                
                    <div class="input-box">
                        <span class="icon">
                            <i class='bx bxs-lock-alt'></i>
                        </span>
                        <input type="password" required>
                        <label>Secret Code (Password)</label>
                    </div>
                
                    <div class="remember-forget">
                        <label><input type="checkbox">Remember my journey</label>
                        <a href="#">Forgot your code?</a>
                    </div>
                
                    <button type="submit" class="btn">Enter the Quest</button>
                    <button type="button" class="btn logout-btn"  id="logoutLink">Leave the Realm (Logout)</button>
                    <div class="login-register">
                        <p>New to the realm? <a href="#" class="register-link">Create a Character</a></p>
                    </div>
                     <!-- Logout Button -->
                     
                </form>
                
            </div>
        </div>
    </div>

    <script>
        // Fetch user details when the page loads
        document.addEventListener('DOMContentLoaded', function () {
            fetchUserDetails();
        });

        async function fetchUserDetails() {
            try {
                const response = await fetch('/user-details', { credentials: 'include' });
                if (!response.ok) {
                    throw new Error('Failed to fetch user details.');
                }
                const data = await response.json();

                if (data.success) {
                    // Update the elements with user email for both sections
                    document.getElementById('userEmail').textContent = data.user.email;
                    document.getElementById('dashboardEmail').textContent = data.user.email;
                } else {
                    console.error('Failed to fetch user details:', data.message);
                }
            } catch (error) {
                console.error('Error fetching user details:', error);
            }
        }

// Add logout functionality
document.getElementById('logoutLink').addEventListener('click', function (event) {
event.preventDefault();
performLogout();
});
async function performLogout() {
try {
const response = await fetch('/logout', {
method: 'POST',
credentials: 'include'
});
if (response.ok) {
// Redirect to  page
window.location.href = 'index.html';
} else {
console.error('Logout failed');
}
} catch (error) {
console.error('Error during logout:', error);
}
}

    </script>

</body>
</html>